<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">
<head>
    <th:block th:replace="~{fragments/layout :: head('Gi·ªè H√†ng')}"></th:block>
    <link rel="stylesheet" th:href="@{/css/giohang.css}">
</head>
<body>
<!-- Header -->
<th:block th:replace="~{fragments/layout :: header}"></th:block>

<!-- Cart Header -->
<div class="cart-header-section">
    <div class="container">
        <h1 class="cart-title">
            <span class="icon">üõí</span>
            Gi·ªè H√†ng C·ªßa B·∫°n
        </h1>
        <div class="cart-progress">
            <div class="progress-step active">
                <div class="step-icon">1</div>
                <span>Gi·ªè H√†ng</span>
            </div>
            <div class="progress-line"></div>
            <div class="progress-step">
                <div class="step-icon">2</div>
                <span>Thanh To√°n</span>
            </div>
            <div class="progress-line"></div>
            <div class="progress-step">
                <div class="step-icon">3</div>
                <span>Ho√†n T·∫•t</span>
            </div>
        </div>
    </div>
</div>

<!-- Cart Section -->
<section class="cart-section">
    <div class="container">
        <div class="cart-content">
            <!-- Cart Items -->
            <div class="cart-items">
                <div class="cart-table">
                    <div class="table-header">
                        <div class="header-item">S·∫£n Ph·∫©m</div>
                        <div class="header-item">ƒê∆°n Gi√°</div>
                        <div class="header-item">S·ªë L∆∞·ª£ng</div>
                        <div class="header-item">Th√†nh Ti·ªÅn</div>
                        <div class="header-item">Thao T√°c</div>
                    </div>

                    <!-- Development Notice - Replace sample data -->
                    <div class="development-notice">
                        <div class="notice-content">
                            <div class="notice-icon">
                                <i class="fas fa-tools"></i>
                            </div>
                            <div class="notice-info">
                                <h3>T√≠nh NƒÉng ƒêang Ph√°t Tri·ªÉn</h3>
                                <p>Gi·ªè h√†ng ƒëang ƒë∆∞·ª£c t√≠ch h·ª£p v·ªõi c∆° s·ªü d·ªØ li·ªáu. Hi·ªán t·∫°i ch∆∞a c√≥ s·∫£n ph·∫©m th·ª±c t·∫ø ƒë∆∞·ª£c
                                    hi·ªÉn th·ªã.</p>
                                <div class="notice-features">
                                    <div class="feature-item">
                                        <i class="fas fa-database text-warning"></i>
                                        <span>K·∫øt n·ªëi Database</span>
                                    </div>
                                    <div class="feature-item">
                                        <i class="fas fa-shopping-cart text-info"></i>
                                        <span>Qu·∫£n l√Ω gi·ªè h√†ng</span>
                                    </div>
                                    <div class="feature-item">
                                        <i class="fas fa-credit-card text-success"></i>
                                        <span>Thanh to√°n online</span>
                                    </div>
                                </div>
                                <div class="notice-actions">
                                    <a class="btn btn-primary" href="/sanpham">
                                        <i class="fas fa-shopping-bag"></i>
                                        Xem S·∫£n Ph·∫©m
                                    </a>
                                    <a class="btn btn-secondary" href="/">
                                        <i class="fas fa-home"></i>
                                        V·ªÅ Trang Ch·ªß
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Cart Actions -->
                <div class="cart-actions">
                    <div class="left-actions">
                        <button class="btn btn-outline" onclick="selectAll()">
                            <i class="fas fa-check-square"></i>
                            Ch·ªçn T·∫•t C·∫£
                        </button>
                        <button class="btn btn-outline" onclick="clearCart()">
                            <i class="fas fa-trash"></i>
                            X√≥a Gi·ªè H√†ng
                        </button>
                    </div>
                    <div class="right-actions">
                        <a class="btn btn-secondary" href="/sanpham">
                            <i class="fas fa-arrow-left"></i>
                            Ti·∫øp T·ª•c Mua S·∫Øm
                        </a>
                    </div>
                </div>
            </div>

            <!-- Cart Summary -->
            <div class="cart-summary">
                <div class="summary-card">
                    <h3 class="summary-title">T√≥m T·∫Øt ƒê∆°n H√†ng</h3>
                    <div class="summary-content">
                        <div class="summary-row">
                            <span>T·∫°m t√≠nh (6 s·∫£n ph·∫©m):</span>
                            <span>2.090.000ƒë</span>
                        </div>

                        <div class="summary-row">
                            <span>Gi·∫£m gi√°:</span>
                            <span class="discount">-100.000ƒë</span>
                        </div>

                        <div class="summary-row">
                            <span>Ph√≠ v·∫≠n chuy·ªÉn:</span>
                            <span class="shipping-fee">
                                    <span class="original-fee">30.000ƒë</span>
                                    <span class="free-shipping">MI·ªÑN PH√ç</span>
                                </span>
                        </div>

                        <div class="summary-row">
                            <span>T·ªïng c·ªông:</span>
                            <span class="total-amount">1.990.000ƒë</span>
                        </div>

                        <!-- Voucher -->
                        <div class="voucher-section">
                            <h4>M√£ Gi·∫£m Gi√°</h4>
                            <div class="voucher-input">
                                <input class="voucher-code" placeholder="Nh·∫≠p m√£ gi·∫£m gi√°..." type="text">
                                <button class="voucher-apply-btn" onclick="applyVoucher()">√Åp D·ª•ng</button>
                            </div>
                            <div class="available-vouchers">
                                <div class="voucher-item">
                                    <div class="voucher-info">
                                        <div class="voucher-code-text">NEWYEAR2025</div>
                                        <div class="voucher-desc">Gi·∫£m 10% ƒë∆°n h√†ng t·ª´ 1 tri·ªáu</div>
                                    </div>
                                    <button class="voucher-select" onclick="selectVoucher('NEWYEAR2025')">Ch·ªçn</button>
                                </div>
                                <div class="voucher-item">
                                    <div class="voucher-info">
                                        <div class="voucher-code-text">FREESHIP</div>
                                        <div class="voucher-desc">Mi·ªÖn ph√≠ v·∫≠n chuy·ªÉn</div>
                                    </div>
                                    <button class="voucher-select" onclick="selectVoucher('FREESHIP')">Ch·ªçn</button>
                                </div>
                            </div>
                        </div>

                        <!-- Checkout Button -->
                        <button class="checkout-btn" onclick="checkout()">
                            <i class="fas fa-credit-card"></i>
                            Ti·∫øn H√†nh Thanh To√°n
                        </button>

                        <!-- Security Info -->
                        <div class="security-info">
                            <div class="security-item">
                                <i class="fas fa-shield-alt"></i>
                                <span>B·∫£o m·∫≠t thanh to√°n 100%</span>
                            </div>
                            <div class="security-item">
                                <i class="fas fa-undo"></i>
                                <span>ƒê·ªïi tr·∫£ trong 7 ng√†y</span>
                            </div>
                            <div class="security-item">
                                <i class="fas fa-shipping-fast"></i>
                                <span>Giao h√†ng nhanh 24h</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Recommendations -->
        <div class="recommendations">
            <h2 class="section-title">C√≥ Th·ªÉ B·∫°n Quan T√¢m</h2>
            <div class="recommendations-grid">
                <div class="recommendation-item">
                    <div class="rec-image">
                        <img alt="M·ª©t D·ª´a Non 500g" src="https://picsum.photos/200/200?random=5">
                    </div>
                    <div class="rec-info">
                        <h4>M·ª©t D·ª´a Non 500g</h4>
                        <div class="rec-price">150.000ƒë</div>
                        <button class="rec-add-btn" onclick="addToCart(5)">
                            <i class="fas fa-plus"></i>
                            Th√™m V√†o Gi·ªè
                        </button>
                    </div>
                </div>

                <div class="recommendation-item">
                    <div class="rec-image">
                        <img alt="B√°nh Ch∆∞ng G√≥i L√° Chu·ªëi" src="https://picsum.photos/200/200?random=6">
                    </div>
                    <div class="rec-info">
                        <h4>B√°nh Ch∆∞ng G√≥i L√° Chu·ªëi</h4>
                        <div class="rec-price">200.000ƒë</div>
                        <button class="rec-add-btn" onclick="addToCart(6)">
                            <i class="fas fa-plus"></i>
                            Th√™m V√†o Gi·ªè
                        </button>
                    </div>
                </div>

                <div class="recommendation-item">
                    <div class="rec-image">
                        <img alt="Ch√πm Nho T√†i L·ªôc" src="https://picsum.photos/200/200?random=7">
                    </div>
                    <div class="rec-info">
                        <h4>Ch√πm Nho T√†i L·ªôc</h4>
                        <div class="rec-price">80.000ƒë</div>
                        <button class="rec-add-btn" onclick="addToCart(7)">
                            <i class="fas fa-plus"></i>
                            Th√™m V√†o Gi·ªè
                        </button>
                    </div>
                </div>

                <div class="recommendation-item">
                    <div class="rec-image">
                        <img alt="Hoa Mai V√†ng Trang Tr√≠" src="https://picsum.photos/200/200?random=8">
                    </div>
                    <div class="rec-info">
                        <h4>Hoa Mai V√†ng Trang Tr√≠</h4>
                        <div class="rec-price">120.000ƒë</div>
                        <button class="rec-add-btn" onclick="addToCart(8)">
                            <i class="fas fa-plus"></i>
                            Th√™m V√†o Gi·ªè
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Footer -->
<th:block th:replace="~{fragments/layout :: footer}"></th:block>

<!-- Scripts -->
<script>
    // Cart functionality
    function updateQuantity(itemId, change) {
        const item = document.getElementById(`item-${itemId}`);
        const quantityInput = item.querySelector('.quantity-input');
        const currentQuantity = parseInt(quantityInput.value);
        const newQuantity = Math.max(1, Math.min(99, currentQuantity + change));

        quantityInput.value = newQuantity;
        updateItemTotal(itemId, newQuantity);
        updateCartSummary();

        // Add loading effect
        item.classList.add('loading');
        setTimeout(() => item.classList.remove('loading'), 500);

        showNotification(`ƒê√£ c·∫≠p nh·∫≠t s·ªë l∆∞·ª£ng th√†nh ${newQuantity}`, 'success');
    }

    function updateItemTotal(itemId, quantity) {
        const item = document.getElementById(`item-${itemId}`);
        const priceText = item.querySelector('.current-price').textContent;
        const price = parseInt(priceText.replace(/[^\d]/g, ''));
        const total = price * quantity;

        item.querySelector('.total-price').textContent = formatPrice(total);
    }

    function removeItem(itemId) {
        if (confirm('B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën x√≥a s·∫£n ph·∫©m n√†y kh·ªèi gi·ªè h√†ng?')) {
            const item = document.getElementById(`item-${itemId}`);
            item.style.animation = 'slideOut 0.3s ease-out forwards';
            setTimeout(() => {
                item.remove();
                updateCartSummary();
                checkEmptyCart();
                showNotification('ƒê√£ x√≥a s·∫£n ph·∫©m kh·ªèi gi·ªè h√†ng', 'success');
            }, 300);
        }
    }

    function selectAll() {
        showNotification('ƒê√£ ch·ªçn t·∫•t c·∫£ s·∫£n ph·∫©m', 'info');
    }

    function clearCart() {
        if (confirm('B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën x√≥a to√†n b·ªô gi·ªè h√†ng?')) {
            const items = document.querySelectorAll('.cart-item');
            items.forEach((item, index) => {
                setTimeout(() => {
                    item.style.animation = 'slideOut 0.3s ease-out forwards';
                    setTimeout(() => item.remove(), 300);
                }, index * 100);
            });

            setTimeout(() => {
                checkEmptyCart();
                showNotification('ƒê√£ x√≥a to√†n b·ªô gi·ªè h√†ng', 'success');
            }, items.length * 100 + 300);
        }
    }

    function selectVoucher(code) {
        document.querySelector('.voucher-code').value = code;
        applyVoucher();
    }

    function applyVoucher() {
        const code = document.querySelector('.voucher-code').value.trim();
        if (code) {
            showNotification(`√Åp d·ª•ng m√£ gi·∫£m gi√° "${code}" th√†nh c√¥ng!`, 'success');
            updateCartSummary();
        } else {
            showNotification('Vui l√≤ng nh·∫≠p m√£ gi·∫£m gi√°!', 'error');
        }
    }

    function checkout() {
        const items = document.querySelectorAll('.cart-item');
        if (items.length === 0) {
            showNotification('Gi·ªè h√†ng c·ªßa b·∫°n ƒëang tr·ªëng!', 'error');
            return;
        }

        showNotification('ƒêang chuy·ªÉn ƒë·∫øn trang thanh to√°n...', 'info');
        setTimeout(() => {
            window.location.href = '/checkout';
        }, 1500);
    }

    function addToCart(productId) {
        showNotification('ƒê√£ th√™m s·∫£n ph·∫©m v√†o gi·ªè h√†ng!', 'success');
    }

    function updateCartSummary() {
        const items = document.querySelectorAll('.cart-item');
        let subtotal = 0;
        let itemCount = 0;

        items.forEach(item => {
            const quantity = parseInt(item.querySelector('.quantity-input').value);
            const priceText = item.querySelector('.current-price').textContent;
            const price = parseInt(priceText.replace(/[^\d]/g, ''));
            subtotal += price * quantity;
            itemCount += quantity;
        });

        // Update item count in summary
        document.querySelector('.summary-row:first-child span:first-child').textContent =
            `T·∫°m t√≠nh (${itemCount} s·∫£n ph·∫©m):`;
    }

    function checkEmptyCart() {
        const cartTable = document.querySelector('.cart-table');
        const items = document.querySelectorAll('.cart-item');

        if (items.length === 0) {
            cartTable.innerHTML = `
                    <div class="empty-cart-container">
                        <div class="empty-cart-icon">üõí</div>
                        <h2 class="empty-cart-title">Gi·ªè h√†ng c·ªßa b·∫°n ƒëang tr·ªëng</h2>
                        <p class="empty-cart-message">H√£y ti·∫øp t·ª•c mua s·∫Øm v√† th√™m s·∫£n ph·∫©m v√†o gi·ªè h√†ng c·ªßa b·∫°n!</p>
                        <a href="/sanpham" class="btn btn-primary btn-lg">
                            <i class="fas fa-shopping-bag"></i>
                            B·∫Øt ƒê·∫ßu Mua S·∫Øm
                        </a>
                    </div>
                `;
        }
    }

    function formatPrice(price) {
        return new Intl.NumberFormat('vi-VN').format(price) + 'ƒë';
    }

    function showNotification(message, type = 'info') {
        const notification = document.createElement('div');
        notification.className = `notification ${type}`;
        notification.innerHTML = `
                <i class="fas fa-${type === 'success' ? 'check-circle' :
            type === 'error' ? 'exclamation-triangle' : 'info-circle'}"></i>
                <span>${message}</span>
            `;

        document.body.appendChild(notification);

        setTimeout(() => {
            notification.style.animation = 'slideOut 0.3s ease-out forwards';
            setTimeout(() => notification.remove(), 300);
        }, 3000);
    }

    // Initialize cart
    document.addEventListener('DOMContentLoaded', function () {
        updateCartSummary();

        // Add smooth animations
        const items = document.querySelectorAll('.cart-item');
        items.forEach((item, index) => {
            item.style.opacity = '0';
            item.style.transform = 'translateY(20px)';
            setTimeout(() => {
                item.style.transition = 'all 0.5s ease';
                item.style.opacity = '1';
                item.style.transform = 'translateY(0)';
            }, index * 100);
        });
    });
</script>

</body>
</html>
